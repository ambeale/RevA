<head>
    <style>
      #map {
          height: 35%;
      }
      #rating-chart div {
          font: 10px sans-serif;
          /*background-color: steelblue;*/
          text-align: right;
          padding: 3px;
          margin: 1px;
          color: white;
      }
      #rating-label {
          font: 13px sans-serif;
          line-height: 19px;
          margin-left: 15px;
      }
      .inline-block-paragraph {
          display: inline-block;
          width: 50px;
          height: 75px;
          font: 10px sans-serif;
          vertical-align: top;
      }
      #center-jumbo {
        margin-top: 20px;
        padding-top: 30px !important; 
        padding-bottom: 30px !important;
      }
      .vertical-align {
        display: flex;
        align-items: center;
      }
      .fa-star {
        color: #fdbf13;
      }
    </style>
</head>

{% extends 'base.html' %}
{% block content %}
<main role="main">
  <div class="container-fluid">
    <div class="row vertical-align">
      <div class="col-sm-10">
        <h2 class="display-4">{{ restaurant.name }} <span id="fav" loggedin="{{ session.get("user_id") }}" rest="{{ restaurant.restaurant_id }}"></span>
        </h2>
      </div>
      <div class="col-sm-2 text-right">
          {% if session.get("user_id") %}
          <form action="/review-form">
              <input type="hidden" name="restaurant-name" value="{{ restaurant.name }}">
              <input type="hidden" name="restaurant-id" value="{{ restaurant.restaurant_id }}">
              <button type="submit" class="btn btn-lg btn-outline-dark">Add a review</button>
          </form>
        {% endif %}
     </div>
</div>
</div>
  
  </h2>
  <div class="jumbotron" id="center-jumbo">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-1"></div>
        <div class="col-md-4">
          <h3>Details</h3>
          <p>
          Address: {{ restaurant.address }}<br>
          Reviews: {{ restaurant.count_reviews }}<br>
          Overall rating: {{ restaurant.reva_rating }}
          </p>
          <h3>Ratings</h3>
          <div id="rating-label" class="inline-block-paragraph">
          Food: <br>
          Service:<br>
          Price: 
          </div>
          <div id="rating-chart" class="inline-block-paragraph" restaurant="{{ restaurant.restaurant_id }}"></div>
        </div>
        <div class="col-md-1"></div>
        <div class="col-md-4">
          <div id="map" lat="{{ restaurant.lat }}" lon="{{ restaurant.lon }}"></div>
        </div>
        <div class="col-md-2"></div>
    </div>
  </div>
</div>


<h1>Reviews</h1>

<form action="/restaurant-dish-search">
    <p class="lead">Search for a dish:
    <input type="text" name="dish-search">
    <input type="hidden" name="restaurant-id" value="{{ restaurant.restaurant_id }}">
    <button type="submit" class="btn btn-outline-dark">Search</button>
    </p>
</form>

<div class="container-fluid">
  <div class="card-columns">
    {% for review in restaurant.reviews %}
      <div class="card">
        <div class="card-header">
          <img src="{{ review.user.icon }}" height="40">
          <a href="/user/{{ review.user.user_id }}">{{ review.user.fname }} {{ review.user.lname }}</a>
        </div>
        <div class="card-body">
            <h5 class="card-title">Food
              {% for n in range(review.food_score) %}
                <i class="fas fa-star"></i>
              {% endfor %}
            </h5>
            <p class="card-text">
              {{ review.food_comment }} 
            </p>
            <h5 class="card-title">Service
              {% for n in range(review.service_score) %}
                <i class="fas fa-star"></i>
              {% endfor %}
            </h5>
            <p class="card-text">  
              {{ review.service_comment }}
            </p>
            <h5 class="card-title">Price
              {% for n in range(review.price_score) %}
                <i class="fas fa-star"></i>
              {% endfor %}
            </h5>
            <p class="card-text"> 
              {{ review.price_comment }}
            </p>
          </div>
        </div>
    {% endfor %}
  </div>
</div>

</main>
{% endblock %}

{% block scripts %}
<script src="/static/js/restaurant_map.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key={{ api_key }}&callback=initMap"
    async defer>
</script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="/static/js/rating_graph.js"></script>
<script src="http://unpkg.com/babel-standalone"></script>
<script src="/static/js/favorite.jsx" type="text/jsx"></script>

{% endblock %}